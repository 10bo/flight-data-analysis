<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Basic API Frontend</title>
    <link
      href="https://fonts.googleapis.com/css?family=Lato&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" class="rel" />
  </head>
  <body>
    <div class="results-container">
      <ul>
        <li id="question-1">
          <span class="question">Which flight has the most stops?</span
          ><span class="answer"></span>
        </li>
        <li id="question-2">
          <span class="question"
            >Which airport day has the most departures from Manchester
            (MAN)?</span
          ><span class="answer"></span>
        </li>
        <li id="question-3">
          <span class="question"
            >How many different flight numbers are on each day?</span
          ><span class="answer"></span>
        </li>
        <li id="question-4">
          <span class="question"
            >What proportion of the flights are business class?</span
          ><span class="answer"></span>
        </li>
        <li id="question-5">
          <span class="question">How many flights are there?</span
          ><span class="answer"></span>
        </li>
      </ul>
    </div>

    <script type="text/javascript">
      'use strict';

      const setQuestion1Answer = flights => {
        let maxStopsFlight = flights[0];
        flights.forEach(checkFlight => {
          if (
            checkFlight.segments &&
            checkFlight.segments.length > maxStopsFlight.segments.length
          ) {
            maxStopsFlight = checkFlight;
          }
        });

        document
          .getElementById('question-1')
          .querySelector(
            '.answer'
          ).textContent = `Flight with ID ${maxStopsFlight.id} stops ${maxStopsFlight.segments.length} times.`;
      };
      const setQuestion2Answer = flights => {
        let day;
        let maxStopsCount = 0;

        document
          .getElementById('question-1')
          .querySelector(
            '.answer'
          ).textContent = `${day} has the most number of flights departing from Manchester.`;
      };
      const setQuestion3Answer = flights => {};
      const setQuestion4Answer = flights => {};
      const request = fetch('http://localhost:3000/get-flight-data/', {
        method: 'GET'
      });

      request
        .then(response => {
          if (!response.ok) {
            throw new Error('Could not fetch flights');
          }
          return response;
        })
        .then(response => response.json())
        .then(responseJson => {
          setQuestion1Answer(responseJson);
          setQuestion2Answer(responseJson);
          setQuestion3Answer(responseJson);
          setQuestion4Answer(responseJson);
          setQuestion5Answer(responseJson);
        });
    </script>
  </body>
</html>
